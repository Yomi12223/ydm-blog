<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>GAME</title>

    <link rel="stylesheet" href="../../style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>

    <audio id="bgm" autoplay loop hidden>
      <source src="../../assets/bgm.mp3" type="audio/mpeg" />
    </audio>

    <div class="top-right-buttons">
      <button id="logout-btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      <button id="mute-btn" class="mute-toggle">ğŸ”Š</button>
    </div>

    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0" />

<header class="main-header">
  <a href="../../" class="main-header-logo-link">
    <img src="../../assets/images/Ydmlabo.png" alt="YDM.LABO ãƒ­ã‚´" class="main-header-logo" />
  </a>
</header>

<div class="time-image">
  <img id="time-background" src="../../assets/time/bg_day.png" alt="æ™‚é–“å¸¯ç”»åƒ" />
</div>




    <nav class="horizontal-menu">
      <ul class="category-list">
        <li><a href="../../posts/">ğŸ“˜ è¨˜äº‹</a></li>
        <li><a href="../../news/">ğŸ“° ãƒ‹ãƒ¥ãƒ¼ã‚¹</a></li>
        <li><a href="../../game/">ğŸ® GAME</a></li>
        <li><a href="../../tools/">ğŸ›  ãƒ„ãƒ¼ãƒ«</a></li>
        <li><a href="../../links/">ğŸ”— ãƒªãƒ³ã‚¯</a></li>
        <li><a href="../../smoothies/">ğŸ¹ ã‚¹ãƒ ãƒ¼ã‚¸ãƒ¼</a></li>
        <li><a href="../../fishdex/">ğŸŸ é­šå›³é‘‘</a></li>
      </ul>
    </nav>

    <div class="page-layout">
      <aside class="sidebar-left">
        <div style="height: 100%; width: 100%; background-color: transparent;"></div>
      </aside>

      <main class="main-content">
      
  <div class="back-button-area">
    
      <a href="../../game/" class="back-button">â† ã‚²ãƒ¼ãƒ ä¸€è¦§ã«æˆ»ã‚‹</a>
    
  </div>


        <h1>ğŸ£ YDM ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚° v2.0 Î²</h1>
<p>é‡£ã‚Šå ´ã‚’é¸ã‚“ã§ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚ˆãé­šã‚’é‡£ã‚Šä¸Šã’ã‚ˆã†ï¼é‡£ã‚ŒãŸé­šã¯å›³é‘‘ã«ç™»éŒ²ã•ã‚Œã‚‹ã‚ˆï¼</p>
<div id="game-container">
  <div id="map-select">
    <button onclick="setStage('pier')">æ¡Ÿæ©‹</button>
    <button onclick="setStage('cave')">æ´çªŸ</button>
    <button onclick="showZukan()">ğŸ“– å›³é‘‘</button>
  </div>
  <canvas id="canvas" width="320" height="240"></canvas><br>
  <button id="start-btn">ğŸ£ é‡£ã‚Šé–‹å§‹ï¼</button>
  <ul id="log"></ul>
</div>
<style>
#game-container {
  background: #001d2e;
  padding: 1em;
  border-radius: 10px;
  color: #e0ffff;
  font-family: monospace;
  max-width: 360px;
}
#map-select {
  margin-bottom: 1em;
}
#map-select button {
  margin-right: 5px;
  background: #0af;
  border: none;
  padding: 0.4em 0.8em;
  border-radius: 5px;
  color: #000;
  font-weight: bold;
  cursor: pointer;
}
#canvas {
  background: #000;
  border: 2px solid #44c;
  border-radius: 8px;
  margin-bottom: 0.5em;
}
#start-btn {
  padding: 0.4em 1em;
  font-weight: bold;
  background: #0f5;
  color: #000;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}
#log {
  margin-top: 1em;
  padding-left: 1em;
  font-size: 0.9rem;
}
</style>
<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("start-btn");
const log = document.getElementById("log");

let state = "idle";
let barX = 0;
let barSpeed = 3.5;
let splash = 0;
let stage = "pier";
let sweetSpot = { start: 130, end: 170 };
let zukan = JSON.parse(localStorage.getItem("zukan") || "[]");

const fishList = {
  pier: [
    { name: "ã‚¢ã‚¸", max: 0.6 },
    { name: "ã‚µãƒ", max: 1.1 },
    { name: "ãƒ–ãƒ©ãƒƒã‚¯ãƒã‚¹", max: 2.5 }
  ],
  cave: [
    { name: "ã‚¿ãƒã‚¦ã‚ª", max: 1.8 },
    { name: "ã‚·ãƒ¼ãƒ©ã‚«ãƒ³ã‚¹", max: 30 },
    { name: "å¹»ã®ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥", max: 50 }
  ]
};

function setStage(name) {
  stage = name;
  log.innerHTML = `<li>ğŸ¯ é‡£ã‚Šå ´ã‚’ã€Œ${name === 'pier' ? 'æ¡Ÿæ©‹' : 'æ´çªŸ'}ã€ã«å¤‰æ›´ï¼</li>`;
}

function showZukan() {
  alert("ğŸ“– é­šå›³é‘‘\\n\\n" + zukan.join("\\n"));
}

function addToZukan(fish) {
  if (!zukan.includes(fish)) {
    zukan.push(fish);
    localStorage.setItem("zukan", JSON.stringify(zukan));
  }
}

function getFish() {
  const fishData = fishList[stage];
  const selected = fishData[Math.floor(Math.random() * fishData.length)];
  const weight = (Math.random() * selected.max + 0.2).toFixed(2);
  return `${selected.name}ï¼ˆ${weight}kgï¼‰`;
}

function drawBG() {
  ctx.fillStyle = stage === "pier" ? "#013" : "#210";
  ctx.fillRect(0, 0, 320, 240);
  ctx.fillStyle = stage === "pier" ? "#044" : "#330";
  ctx.fillRect(0, stage === "pier" ? 180 : 160, 320, 80);
}

function drawBar() {
  ctx.fillStyle = "#060";
  ctx.fillRect(sweetSpot.start, 100, sweetSpot.end - sweetSpot.start, 40);
  ctx.fillStyle = "#0ff";
  ctx.fillRect(barX, 90, 5, 60);
}

function drawSplash() {
  ctx.fillStyle = "#fff";
  for (let i = 0; i < 8; i++) {
    ctx.beginPath();
    ctx.arc(Math.random()*320, 120+Math.random()*40, 2+Math.random()*2, 0, Math.PI*2);
    ctx.fill();
  }
}

function update() {
  if (state === "running") {
    barX += barSpeed;
    if (barX < 0 || barX > 315) barSpeed *= -1;
  }
}

function draw() {
  drawBG();
  update(); // âœ… ãƒãƒ¼ã®ä½ç½®ã‚’æ›´æ–°ã™ã‚‹ï¼
  if (state === "running") drawBar();
  if (splash > 0) {
    drawSplash();
    splash--;
  }
  requestAnimationFrame(draw);
}


canvas.addEventListener("click", () => {
  if (state !== "running") return;
  state = "result";
  let li = document.createElement("li");
  if (barX >= sweetSpot.start && barX <= sweetSpot.end) {
    let fish = getFish();
    li.innerHTML = `ğŸ‰ <b>é‡£ã‚ŒãŸï¼</b> ${fish}`;
    splash = 10;
    addToZukan(fish.split("ï¼ˆ")[0]);
  } else {
    li.innerHTML = `ğŸ’¨ <i>é€ƒã’ã‚‰ã‚ŒãŸâ€¦</i>`;
  }
  log.appendChild(li);
});

btn.addEventListener("click", () => {
  barX = 0;
  barSpeed = 3 + Math.random() * 3;
  state = "running";
});

draw();
</script>
<div class="back-button-area">
  <a href="../../game/" class="back-button">â‡ã‚²ãƒ¼ãƒ ä¸€è¦§ã«æˆ»ã‚‹</a>
</div>

      </main>

      <div id="fish-container"></div>


      <aside class="sidebar-right">
        <div class="latest-posts-sidebar">
  <div class="fishdex-box">
  <h3><a href="../../fishdex/">ğŸŸ é­šå›³é‘‘ï¼ˆä»®ï¼‰</a></h3>
  <p>æº–å‚™ä¸­ã®é­šå›³é‘‘ã§ã™ã€‚</p>
</div>








          <h3>ğŸ“˜ æœ€æ–°è¨˜äº‹</h3>
          <ul>
            
              <li>
                <a href="/posts/001/">åˆæŠ•ç¨¿</a>
              </li>
            
          </ul>
        </div>

        <h3>SNS</h3>
        <ul>
          <li><a href="#">Twitter</a></li>
          <li><a href="#">YouTube</a></li>
        </ul>
        

        
      </aside>
    </div>

    <footer class="site-footer">
      <p>&copy; 2025 YDM.LABO</p>
      <div class="footer-msg">ã“ã®ãƒ–ãƒ­ã‚°ã¯ç§˜å¯†åŸºåœ°ã‹ã‚‰ãŠå±Šã‘ã—ã¦ã„ã¾ã™âš™ï¸</div>
    </footer>

    <div id="bgm-modal" class="bgm-modal hidden">
      <div class="bgm-modal-content">
        <p>BGMã‚’å†ç”Ÿã—ã¾ã™ã‹ï¼Ÿ</p>
        <div class="modal-buttons">
          <button id="bgm-yes">å†ç”Ÿã™ã‚‹</button>
          <button id="bgm-no">å†ç”Ÿã—ãªã„</button>
        </div>
      </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
      const bgm = document.getElementById('bgm');
      const muteBtn = document.getElementById('mute-btn');
      const logoutBtn = document.getElementById('logout-btn');
      const volumeSlider = document.getElementById('volume-slider');

      // åˆæœŸè¨­å®šï¼šéŸ³é‡0ï¼ˆãƒŸãƒ¥ãƒ¼ãƒˆçŠ¶æ…‹ï¼‰
      bgm.volume = 0;
      volumeSlider.value = 0;
      muteBtn.textContent = 'ğŸ”‡';

      // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰è¨­å®šã‚’å¾©å…ƒ
      const savedVolume = localStorage.getItem('ydm-volume');
      if (savedVolume !== null) {
        const vol = parseFloat(savedVolume);
        bgm.volume = vol;
        volumeSlider.value = vol;
        muteBtn.textContent = vol === 0 ? 'ğŸ”‡' : 'ğŸ”Š';
      }

      // ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³
      muteBtn.addEventListener('click', () => {
        if (bgm.volume > 0) {
          bgm.volume = 0;
          volumeSlider.value = 0;
          muteBtn.textContent = 'ğŸ”‡';
          localStorage.setItem('ydm-volume', '0');
        } else {
          bgm.volume = 0.3;
          volumeSlider.value = 0.3;
          muteBtn.textContent = 'ğŸ”Š';
          localStorage.setItem('ydm-volume', '0.3');
        }
      });

      // éŸ³é‡ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼
      volumeSlider.addEventListener('input', () => {
        const vol = parseFloat(volumeSlider.value);
        bgm.volume = vol;
        muteBtn.textContent = vol === 0 ? 'ï¿½' : 'ï¿½ğŸ”Š';
        localStorage.setItem('ydm-volume', vol);
      });

      // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³
      logoutBtn.addEventListener('click', () => {
        localStorage.removeItem('ydm-login');
        window.location.href = '../../login/';
      });

      // æ™‚é–“å¸¯èƒŒæ™¯
      const img = document.getElementById("time-background");
      const now = new Date().getHours();
      
      if (now >= 6 && now < 17) {
        img.src = "../../assets/time/bg_day.png";
      } else if (now >= 17 && now < 20) {
        img.src = "../../assets/time/bg_evening.png";
      } else {
        img.src = "../../assets/time/bg_night.png";
      }
    });
    </script>

<!-- SVGãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼šå¿…ãšã“ã‚Œã‚’1å›ã ã‘ï¼ -->
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <filter id="waterDistortion">
    <feTurbulence id="turbulence" type="turbulence" baseFrequency="0.003" numOctaves="1" result="turb"/>
    <feDisplacementMap in="SourceGraphic" in2="turb" scale="7" xChannelSelector="R" yChannelSelector="G"/>
  </filter>
</svg>

<!-- æ·±åº¦ãƒ¡ãƒ¼ã‚¿ãƒ¼æœ¬ä½“ -->
<div class="depth-meter">
  <div class="depth-indicator-line" id="depthLine"></div>
  <div class="depth-label" id="depthLabel">0m</div>
</div>

<script>
  window.addEventListener("DOMContentLoaded", () => {
    const label = document.getElementById("depthLabel");
    const line = document.getElementById("depthLine");
    const turbulence = document.getElementById("turbulence");
    let frame = 0;

    function animate() {
      const bf = 0.003 + Math.sin(frame / 60) * 0.001;
      turbulence.setAttribute("baseFrequency", bf.toFixed(5));
      frame++;
      requestAnimationFrame(animate);
    }

    window.addEventListener("scroll", () => {
      const depth = Math.floor(window.scrollY / 10);
      label.textContent = `${depth}m`;
      line.style.top = `${window.innerHeight / 5.58}px`;
    });

    animate();
  });
</script>



<!-- <script>
  document.addEventListener("DOMContentLoaded", () => {
    const fishContainer = document.getElementById("fish-container");

    function spawnFish() {
      const fish = document.createElement("div");
      fish.className = "fish-shadow";
      fish.style.position = "absolute";

      // ãƒ©ãƒ³ãƒ€ãƒ Yä½ç½®
      const y = Math.random() * (window.innerHeight / 2) + (window.innerHeight / 2);
      fish.style.top = `${y}px`;

      // ãƒ©ãƒ³ãƒ€ãƒ æ–¹å‘
      const fromLeft = Math.random() < 0.5;
      const speed = 1.2;
      let posX = fromLeft ? -150 : window.innerWidth + 150;

      fish.style.left = `${posX}px`;

      // å³ã‹ã‚‰æ¥ã‚‹é­šã¯åè»¢
      if (!fromLeft) {
        fish.style.transform = "scaleX(-1)";
      }

      fishContainer.appendChild(fish);

      // ã‚¢ãƒ‹ãƒ¡é–‹å§‹
      let animationId;
      function move() {
        posX += fromLeft ? speed : -speed;
        fish.style.left = `${posX}px`;
        animationId = requestAnimationFrame(move);
      }

      move();

      // ğŸŸ è·³ã­ã‚‹å‡¦ç†
      fish.addEventListener("click", () => {
        cancelAnimationFrame(animationId);
        fish.classList.add("jumping");

        fish.addEventListener("animationend", () => {
          fish.remove();
        }, { once: true });
      });

      // è‡ªå‹•æ¶ˆæ»…ã¾ã§ã®æ™‚é–“ï¼ˆé•·ã‚ã«ï¼ï¼‰
      setTimeout(() => {
        cancelAnimationFrame(animationId);
        if (fish.parentElement) fish.remove();
      }, 24000);

      // å‡ºç¾é »åº¦ï¼ˆ3å€é…ã„ï¼‰
      setTimeout(spawnFish, Math.random() * 15000 + 9000);
    }

    spawnFish();
  });
</script> -->

  </body>
</html>
